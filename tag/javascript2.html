<!DOCTYPE html>

<html lang="de">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>möchte­gern­geek - JavaScript tag</title>
<meta content="Dinge, die ich für hübsch, praktisch oder interessant halte." name="description"/>
<meta content="Hendrik Schawe" name="author"/>
<meta content="Hendrik Schawe" name="copyright"/>
<meta content="#3d4f5d" name="theme-color"/>
<link href="/manifest.json" rel="manifest"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<!-- Add to home screen for Safari on iOS-->
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="default" name="apple-mobile-web-app-status-bar-style"/>
<meta content="möchtegerngeek" name="apple-mobile-web-app-title"/>
<link href="/extra/icons/icon-152x152.png" rel="apple-touch-icon"/>
<!-- Add to home screen for Windows-->
<meta content="/extra/icons/icon-152x152.png" name="msapplication-TileImage"/>
<meta content="#b0cadb" name="msapplication-TileColor"/>
<meta content="möchte­gern­geek" property="og:site_name"/>
<meta content="Hendrik Schawe" property="og:article:author"/>
<meta content="article" property="og:type"/>
<meta content="summary" name="twitter:card"/>
<meta content="https://blog.schawe.me/img/logo.png" property="og:image"/>
<meta content="https://blog.schawe.me/img/logo.png" name="twitter:image"/>
<link href="https://blog.schawe.me/tag/javascript2.html" hreflang="de" rel="alternate">
<link href="https://blog.schawe.me/en/tag/javascript2.html" hreflang="en" rel="alternate">
<link href="https://blog.schawe.me/tag/javascript2.html" hreflang="x-default" rel="alternate">
<link href="/theme/webassets-external/6fc8b5d0286641a8981481d8734adb14_pure-min.css" rel="stylesheet" type="text/css"/>
<link href="/theme/webassets-external/cd1fc9b8f4fd6935866873d6d3cfad1b_grids-responsive-min.css" rel="stylesheet" type="text/css"/>
<link href="/theme/css/blog.css" rel="stylesheet" type="text/css"/>
<script async="" src="/theme/js/mathjax-config.js"></script>
<script async="" crossorigin="anonymous" data-search-pseudo-elements="" integrity="sha512-RXf+QSDCUQs5uwRKaDoXt55jygZZm2V++WUZduaU/Ui/9EGp3f/2KZVahFZBKGH0s774sd3HmrhUy+SgOFQLVQ==" referrerpolicy="no-referrer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
<!-- Preload the other fonts early -->
<link as="font" crossorigin="anonymous" href="/theme/woff2/Merriweather-12ptRegular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/FiraSans-Regular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/FiraSans-Bold.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/Merriweather-12ptItalic.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/firacode-regular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/firacode-bold.woff2" rel="prefetch" type="font/woff2"/>
<link href="https://blog.schawe.me/feeds/all.atom.xml" rel="alternate" title="möchte­gern­geek - Full Atom Feed" type="application/atom+xml">
</link></link></link></link></head>
<body>
<div class="pure-g" id="layout">
<div class="sidebar pure-u-1 pure-u-lg-1-4">
<div class="header">
<h1 class="brand-title"><a href="https://blog.schawe.me">möchte­gern­geek</a></h1>
<nav class="nav">
<ul class="nav-list container">
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/en/"><i class="fa fa-globe"></i> en</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/categories.html">Kategorien</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/tags.html">Tags</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/archives.html">Archiv</a>
</li>
</ul>
</nav>
<div class="container">
<a class="sidebar-social-links" href="https://hendrik.schawe.me" rel="noopener" target="_blank" title="Ich">
<i class="fas fa-user sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="https://github.com/surt91" rel="noopener" target="_blank" title="GitHub">
<i class="fab fa-github sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="mailto:hendrik.schawe+blog@gmail.com" rel="noopener" target="_blank" title="Email">
<i class="fas fa-envelope sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="https://twitter.com/surt91" rel="noopener" target="_blank" title="Twitter">
<i class="fab fa-twitter sidebar-social-links"></i>
</a>
</div>
<div class="container">
<form action="https://blog.schawe.me/search.html" class="pure-form">
<fieldset>
<input aria-label="Suche" class="search-query" id="tipue_search_input" name="q" placeholder="Suche" type="text"/>
</fieldset>
</form>
</div>
</div>
</div>
<div class="content pure-u-1 pure-u-lg-3-4">
<div class="posts">
<article class="post">
<header>
<h2 class="post-title">
<a href="https://blog.schawe.me/image-preview.html"> Platzhalterbilder  </a>
</h2>
<div class="post-meta">
<time class="post-time" datetime="2017-11-29T10:21:00+01:00">29.11.2017</time>
<span class="category category-meta">
<a href="https://blog.schawe.me/categories.html#meta-ref">Meta</a>
</span>
<span class="tags-in-article">
<span class="tag">
<a href="https://blog.schawe.me/tags.html#bild-ref">Bild</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#javascript-ref">JavaScript</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#python-ref">Python</a>
</span>
</span>
</div>
</header>
<div class="post-content">
<p>Große Bilder können die Ladezeit von Webseiten dramatisch verschlechtern.
Schlimmer als weiße Flächen ist das sprungartige Verschieben des Textes, wenn
weiter oben gerade ein Bild fertig geladen wurde. Allerdings müssen Bilder bei
immer weiter steigenden Pixeldichten der Anzeigegeräte auch immer
hochaufgelöster werden und gleichzeitig über langsame 3G-Verbindungen
geladen werden.</p>
<p>Da der <a href="https://blog.schawe.me/randomFractals.html">Eintrag über Fraktale</a> einige recht große
Bilder enthält, habe ich ein Pelican-Plugin geschrieben, das</p>
<ol>
<li>Vorschau-.jpg erzeugt, die in der Regel kleiner als 1 kB sind,</li>
<li>jedes Bild durch die data-uri des Previews ersetzt und dies verschwommen anzeigt, bis das Originalbild per JavaScript nachgeladen ist.</li>
</ol>
<p>Das sieht dann etwa so aus:</p>
<video controls="" height="460" width="800">
<source src="/vid/image_preview.mp4" type="video/mp4"/>
Your browser does not support the video tag.
</video>
<p>Glücklicherweise ist es recht einfach mit Python html zu parsen und data-uri
zu erzeugen, sodass mein Plugin im Wesentlichen fertig generiertes html nimmt
und folgendes tut:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"file.html"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"img"</span><span class="p">):</span>
        <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">create_thumbnail</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)</span>
        <span class="n">data_uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"data:image/jpeg;base64,</span><span class="si">{</span><span class="n">b64</span><span class="si">}</span><span class="s2">"</span>
        <span class="c1"># TODO: replace img source by the data-uri</span>
</code></pre></div>
<p>Nachdem alles vorbereitet ist, ist die clientseitige Logik mit ein paar Zeilen
<a href="https://github.com/surt91/purepelican/blob/1e1371d644de4b3af733e78bebe4869bc9121681/static/js/img.js">JavaScript</a>
und <a href="https://github.com/surt91/purepelican/blob/1e1371d644de4b3af733e78bebe4869bc9121681/static/sass/_images.scss"><span class="caps">CSS</span></a>
recht simpel.</p>
<p>Die Idee ist, dynamisch die voll aufgelösten Bilder per JavaScript zu laden und
mit dem <code>onLoad</code> Event sichtbar zu machen.</p>
</div>
</article>
<article class="post">
<header>
<h2 class="post-title">
<a href="https://blog.schawe.me/jsnake.html"> jsnake  </a>
</h2>
<div class="post-meta">
<time class="post-time" datetime="2017-11-02T17:30:00+01:00">02.11.2017</time>
<span class="category category-code">
<a href="https://blog.schawe.me/categories.html#code-ref">Code</a>
</span>
<span class="tags-in-article">
<span class="tag">
<a href="https://blog.schawe.me/tags.html#game-ref">Game</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#javascript-ref">JavaScript</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#snake-ref">Snake</a>
</span>
</span>
</div>
</header>
<div class="post-content">
<p>Bisher habe ich immer nur kurze Fragmente in JavaScript geschrieben, die
meist nur Gimmicks bezweckten oder Bibliotheken aufrufen. JavaScript ist im
Moment möglicherweise die wichtigste Sprache: Schließlich ist sämtlicher
clientseitiger Code des Webs JavaScript — und dank Node wohl auch nennenswerte
Teile des Servercodes. Zumindest macht man nichts falsch, wenn man sich etwas
mit JavaScript vertraut macht.
Deshalb ist das neuste — und simpelste — Mitglied meiner Snake Sammlung
[<a href="https://blog.schawe.me/snake.html">1</a>, <a href="https://blog.schawe.me/pysnake.html">2</a>, <a href="https://blog.schawe.me/msnake.html">3</a>, <a href="https://blog.schawe.me/rsnake.html">4</a>]
in JavaScript gehalten.</p>
<p>Ausprobieren kann man es gleich hier:</p>
<canvas class="fixed-size-400 center" id="jsnake"></canvas>
<script async="" src="/js/jsnake/jsnake.js"></script>
<p>In der Spielwelt herrschen helikale Randbedingungen, hauptsächlich weil es etwas
anderes ist als gewöhnliche periodische Ränder. Außerdem hat es den Vorteil,
dass man keinen Pause-Modus braucht, weil diese Randbedingungen dafür sorgen,
dass die Schlange sich nicht beißt, wenn man sie einfach geradeaus laufen lässt.</p>
<p>Ich habe gehört, dass JavaScript sich in den letzten Jahren stark
weiterentwickelt hat. Tatsächlich scheint mir
diese Sprache einige interessante Sprachelemente erhalten zu haben, wie <em>arrow
functions</em> <code>x =&gt; x*x</code> für lambdas oder den <em>spread operator</em> <code>...</code> den ich am
ehesten mit Pythons <em>splat</em> <code>*</code> vergleichen möchte.
Ich will nicht behaupten, dass das folgende kartesische Produkt der beste Code
oder leserlich wäre, aber interessant allemal:</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[...</span><span class="nb">Array</span><span class="p">(</span><span class="nx">SIZE</span><span class="p">).</span><span class="nx">keys</span><span class="p">()];</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[].</span><span class="nx">concat</span><span class="p">(</span>
<span class="w">    </span><span class="p">...</span><span class="nx">numbers</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span>
<span class="w">        </span><span class="nx">x</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">numbers</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span>
<span class="w">            </span><span class="nx">y</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">[</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">]</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</code></pre></div>
<p>Anscheinend gibt es mit der nächsten geplanten Version (<span class="caps">ES6</span>) noch mehr nette
Sprachelemente. Unter anderem <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">Module</a>.
Ich bin geradezu sprachlos, dass man bisher keine Sprachunterstützung für
die Verteilung des Quellcodes über mehrere Dateien hatte. Anscheinend bin ich
noch zu sehr von den Konzepten der „C-artigen“ Sprachen beeinflusst.</p>
<p>Da <code>jsnake</code> nur ein paar Zeilen in einer Datei sind und sich ein ganzes GitHub
Repository deshalb nicht lohnt, habe ich es in einen <a href="https://gist.github.com/surt91/42eb076974e325433b66a5077d4623eb">Gist</a> hochgeladen.</p>
</div>
</article>
<article class="post">
<header>
<h2 class="post-title">
<a href="https://blog.schawe.me/progressive-web-app.html"> Progressive Web App  </a>
</h2>
<div class="post-meta">
<time class="post-time" datetime="2017-09-01T18:15:00+02:00">01.09.2017</time>
<span class="category category-meta">
<a href="https://blog.schawe.me/categories.html#meta-ref">Meta</a>
</span>
<span class="tags-in-article">
<span class="tag">
<a href="https://blog.schawe.me/tags.html#javascript-ref">JavaScript</a>
</span>
</span>
</div>
</header>
<div class="post-content">
<p>Seit Anfang September ist dieses Blog eine <em>Progressive Web App</em>. Das bedeutet,
dass dieses Blog nun auch offline funktioniert und man es auf dem Smartphone
als App hinzufügen kann.</p>
<h3>Warum? <a href="https://developers.google.com/web/tools/lighthouse/"><img alt="Lighthouse" class="icon" height="1042" src="/img/lighthouse.png" width="1850"/></a></h3>
<p>Nun, Chrome bietet mit <em>Lighthouse</em> Ratschläge, wie man seine Website verbessern
kann. Einer der vier Unterpunkte heißt <em>Progressive Web App</em> und war frustrierend
schlecht bewertet. Die folgenden Schritte habe ich also nur für Lighthouse
gemacht und es hat sich auf jeden Fall gelohnt:</p>
<p><img alt="Lighthouse-Audit Ergebnisse" height="86" src="/img/lighthouse_audit.png" width="625"/></p>
<h3>Wie?</h3>
<p>Lighthouse bietet eine Checkliste, auf der neben einigen Punkten, die
generell eine gute Idee sind, drei Punkte aufgeführt sind, die erfüllt sein müssen:</p>
<ul>
<li>Site is served over <span class="caps">HTTPS</span><ul>
<li>Dank <em>Let’s Encrypt</em> ist das kein Problem mehr.</li>
</ul>
</li>
<li>The start <span class="caps">URL</span> (at least) loads while offline<ul>
<li>Das ist der aufwendigste Teil. Um dies zu erreichen muss man einen
<em>service worker</em> registrieren. Damit der <em>service worker</em> weiß, welche
Dateien notwendig sind, benutze ich nach jedem erfolgreichen Build
<a href="https://github.com/GoogleChrome/sw-precache">sw-precache</a> mit einer
<a href="https://github.com/surt91/blog/blob/1d29d7bd848e31bfa4dc3f57bd140e92cbdf6de5/sw-config.js">sehr einfachen Konfiguration</a>.
Dadurch benötige ich jetzt Node, um das Blog zu erstellen <code>¯\_(ツ)_/¯</code></li>
</ul>
</li>
<li>Metadata provided for Add to Home screen<ul>
<li>Damit ist eine <code>manifest.json</code> gemeint. Diese Datei enthält links zu Icons,
die als Appsymbol benutzt werden, wenn man die Seite auf Android oder Windows
installiert. Und es legt die Farbe der Adressleiste im mobilen Chrome fest.
Ein nützlicher Dienst, um ein solches Manifest zu erstellen, ist
<a href="https://app-manifest.firebaseapp.com/">app-manifest.firebaseapp.com</a></li>
</ul>
</li>
</ul>
<h2>Was jetzt?</h2>
<p>Service Worker ermöglichen Benachrichtigungen von einer Website. Ein natürlicher
nächster Schritt wäre es also Benachrichtigungen zu versenden, wenn ein neuer
Post online ist. Auf der anderen Seite bin ich selbst immer etwas genervt von
Websites, die mich benachrichtigen wollen und der Lighthouse Punktestand ist
schon optimal, also wird das wohl nicht passieren.</p>
</div>
</article>
</div>
<div class="post-navigation">
<nav class="pagination">
<a href="https://blog.schawe.me/tag/javascript.html">← Neuer</a>
<span class="separatordot">·</span>
<a href="https://blog.schawe.me/tag/javascript3.html">Älter →</a>
<br/>
            2 / 3
        </nav>
</div>
</div>
<div id="last-update">
<time datetime="2024-12-27 10:29:03">10:29:03 27.12.2024</time>
</div>
</div>
<script async="" src="/theme/webassets-external/0cf7968c252ead5c096e55c1f7673096_rythm.js"></script>
<script async="" src="/theme/webassets-external/a8b690a4c23c0610ea6538a9352534be_totally_serious_script.js"></script>
<script async="" src="/theme/js/unregister_service_worker.js"></script>
</body>
</html>