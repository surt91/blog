<!DOCTYPE html>

<html lang="de">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>möchte­gern­geek - Code category</title>
<meta content="Dinge, die ich für hübsch, praktisch oder interessant halte." name="description"/>
<meta content="Hendrik Schawe" name="author"/>
<meta content="Hendrik Schawe" name="copyright"/>
<meta content="#3d4f5d" name="theme-color"/>
<link href="/manifest.json" rel="manifest"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<!-- Add to home screen for Safari on iOS-->
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="default" name="apple-mobile-web-app-status-bar-style"/>
<meta content="möchtegerngeek" name="apple-mobile-web-app-title"/>
<link href="/extra/icons/icon-152x152.png" rel="apple-touch-icon"/>
<!-- Add to home screen for Windows-->
<meta content="/extra/icons/icon-152x152.png" name="msapplication-TileImage"/>
<meta content="#b0cadb" name="msapplication-TileColor"/>
<meta content="möchte­gern­geek" property="og:site_name"/>
<meta content="Hendrik Schawe" property="og:article:author"/>
<meta content="article" property="og:type"/>
<meta content="summary" name="twitter:card"/>
<meta content="https://blog.schawe.me/img/logo.png" property="og:image"/>
<meta content="https://blog.schawe.me/img/logo.png" name="twitter:image"/>
<link href="https://blog.schawe.me/category/code7.html" hreflang="de" rel="alternate">
<link href="https://blog.schawe.me/en/category/code7.html" hreflang="en" rel="alternate">
<link href="https://blog.schawe.me/category/code7.html" hreflang="x-default" rel="alternate">
<link href="/theme/webassets-external/6fc8b5d0286641a8981481d8734adb14_pure-min.css" rel="stylesheet" type="text/css"/>
<link href="/theme/webassets-external/cd1fc9b8f4fd6935866873d6d3cfad1b_grids-responsive-min.css" rel="stylesheet" type="text/css"/>
<link href="/theme/css/blog.css" rel="stylesheet" type="text/css"/>
<script async="" src="/theme/js/mathjax-config.js"></script>
<script async="" crossorigin="anonymous" data-search-pseudo-elements="" integrity="sha512-RXf+QSDCUQs5uwRKaDoXt55jygZZm2V++WUZduaU/Ui/9EGp3f/2KZVahFZBKGH0s774sd3HmrhUy+SgOFQLVQ==" referrerpolicy="no-referrer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
<!-- Preload the other fonts early -->
<link as="font" crossorigin="anonymous" href="/theme/woff2/Merriweather-12ptRegular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/FiraSans-Regular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/FiraSans-Bold.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/Merriweather-12ptItalic.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/firacode-regular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/firacode-bold.woff2" rel="prefetch" type="font/woff2"/>
<link href="https://blog.schawe.me/feeds/all.atom.xml" rel="alternate" title="möchte­gern­geek - Full Atom Feed" type="application/atom+xml">
</link></link></link></link></head>
<body>
<div class="pure-g" id="layout">
<div class="sidebar pure-u-1 pure-u-lg-1-4">
<div class="header">
<h1 class="brand-title"><a href="https://blog.schawe.me">möchte­gern­geek</a></h1>
<nav class="nav">
<ul class="nav-list container">
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/en/"><i class="fa fa-globe"></i> en</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/categories.html">Kategorien</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/tags.html">Tags</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/archives.html">Archiv</a>
</li>
</ul>
</nav>
<div class="container">
<a class="sidebar-social-links" href="https://hendrik.schawe.me" rel="noopener" target="_blank" title="Ich">
<i class="fas fa-user sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="https://github.com/surt91" rel="noopener" target="_blank" title="GitHub">
<i class="fab fa-github sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="mailto:hendrik.schawe+blog@gmail.com" rel="noopener" target="_blank" title="Email">
<i class="fas fa-envelope sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="https://twitter.com/surt91" rel="noopener" target="_blank" title="Twitter">
<i class="fab fa-twitter sidebar-social-links"></i>
</a>
</div>
<div class="container">
<form action="https://blog.schawe.me/search.html" class="pure-form">
<fieldset>
<input aria-label="Suche" class="search-query" id="tipue_search_input" name="q" placeholder="Suche" type="text"/>
</fieldset>
</form>
</div>
</div>
</div>
<div class="content pure-u-1 pure-u-lg-3-4">
<div class="posts">
<article class="post">
<header>
<h2 class="post-title">
<a href="https://blog.schawe.me/perfect-dependencies.html"> Perfect Dependencies  </a>
</h2>
<div class="post-meta">
<time class="post-time" datetime="2016-09-17T20:27:00+02:00">17.09.2016</time>
<span class="category category-code">
<a href="https://blog.schawe.me/categories.html#code-ref">Code</a>
</span>
<span class="tags-in-article">
<span class="tag">
<a href="https://blog.schawe.me/tags.html#c-ref">C++</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#make-ref">make</a>
</span>
</span>
</div>
</header>
<div class="post-content">
<p>Man hat ein großes C++ Projekt, ändert einen Header, führt <code>make</code> aus und
ein seltsamer Fehler tritt im Programm auf. Das liegt natürlich daran, dass
<code>make</code> nicht alle Quelldateien neu kompiliert hat, die den Header einbinden.
Woher sollte <code>make</code> das auch wissen? Alle Header per Hand in der <code>Makefile</code>
einzutragen und zu pflegen, ist Wahnsinn und wird den Programmierer in denselben treiben.</p>
<p><code>make</code> ist ein sehr allgemein gehaltenes Programm, wie ich in einem <a href="https://blog.schawe.me/make.html">vorherigen Eintrag</a>
gezeigt habe. Sich um Eigenheiten von C oder C++ zu kümmern fällt also nicht
in den Aufgabenbereich von <code>make</code>. Aber glücklicherweise gibt es ein Programm,
dessen Hauptaufgabe es ist, sich mit den Eigenheiten von C bzw. C++ auszukennen:
den Compiler.
Tatsächlich bietet (zumindest <span class="caps">GCC</span>) die Option eine C oder C++ Datei zu parsen
und alle inkludierten Header auszugeben.</p>
<div class="highlight"><pre><span></span><code>g++<span class="w"> </span>-MM<span class="w"> </span>myCode.cpp
</code></pre></div>
<p>Das ausnutzend, bietet die <a href="https://www.gnu.org/software/make/manual/">offizielle Dokumentation</a>
von <code>GNU make</code> folgende Rule, um je eine „dependency“ <code>Makefile</code>
pro <code>.c</code> Datei zu erzeugen und automatisch einzubinden.</p>
<div class="highlight"><pre><span></span><code><span class="nf">%.d</span><span class="o">:</span><span class="w"> </span>%.<span class="n">c</span>
<span class="w">    </span>@set<span class="w"> </span>-e<span class="p">;</span><span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="nv">$@</span><span class="p">;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="k">$(</span>CC<span class="k">)</span><span class="w"> </span>-M<span class="w"> </span><span class="k">$(</span>CPPFLAGS<span class="k">)</span><span class="w"> </span>$&lt;<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$@</span>.<span class="nv">$$$$</span><span class="p">;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>sed<span class="w"> </span>’s,<span class="se">\(</span><span class="nv">$*</span><span class="se">\)\.</span>o<span class="o">[</span><span class="w"> </span>:<span class="o">]</span>*,<span class="se">\1</span>.o<span class="w"> </span><span class="nv">$@</span><span class="w"> </span>:<span class="w"> </span>,g’<span class="w"> </span>&lt;<span class="w"> </span><span class="nv">$@</span>.<span class="nv">$$$$</span><span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$@</span><span class="p">;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>rm<span class="w"> </span>-f<span class="w"> </span><span class="nv">$@</span>.<span class="nv">$$$$</span>

<span class="cp">include $(sources:.c=.d)</span>
</code></pre></div>
<p>Falls man <code>.o</code> Dateien in ein <code>obj/</code> Verzeichnis speichert, muss man die
Regex anpassen. In meinen Projekten leistet mir diese Rule gute Dienste.</p>
<p>Alternativ könnte man natürlich auf ein anderes Buildsystem statt handgepflegter
Makefiles umsteigen.</p>
</div>
</article>
<article class="post">
<header>
<h2 class="post-title">
<a href="https://blog.schawe.me/tspview.html"> TSPview  </a>
</h2>
<div class="post-meta">
<time class="post-time" datetime="2016-09-17T15:41:00+02:00">17.09.2016</time>
<span class="category category-code">
<a href="https://blog.schawe.me/categories.html#code-ref">Code</a>
</span>
<span class="tags-in-article">
<span class="tag">
<a href="https://blog.schawe.me/tags.html#bild-ref">Bild</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#c-ref">C++</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#code-ref">Code</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#github-ref">GitHub</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#python-ref">Python</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#video-ref">Video</a>
</span>
</span>
</div>
</header>
<div class="post-content">
<p>Das Problem des Handlungsreisenden ist es, die kürzeste Rundtour zu planen,
sodass man alle Städte besucht. Es ist eines der berühmtesten
Optimierungsprobleme und gehört zur Klasse <a href="https://de.wikipedia.org/wiki/NP-Schwere"><span class="caps">NP</span>-hard</a>.</p>
<p>Es gibt also (<a href="https://de.wikipedia.org/wiki/P-NP-Problem">bis jetzt</a>)
keine effiziente Möglichkeit zur Lösung. Allerdings gibt es
<a href="https://scholar.google.fr/scholar?q=euclidean+tsp+ptas&amp;hl=de">Näherungen</a>,
<a href="https://scholar.google.fr/scholar?q=tsp+linear+programming">untere Schranken</a>
und unzählige Heuristiken.</p>
<p>Die einfachsten dieser Heuristiken habe ich in einem kleinen Programm TSPview
implementiert, mitsamt Visualisierung. Der Quellcode ist auf
<a href="https://github.com/surt91/TSPview">GitHub</a> zu finden.</p>
<video controls="" loop="" width="100%">
<source src="/vid/tspview2.mp4" type="video/mp4"/>
Your browser does not support the video tag.
</video>
<h2>Algorithmen</h2>
<p>Hier folgt eine kurze Beschreibung der verwendeten Algorithmen und jeweils ein
Bild, welche Lösung die Methode auf einer berühmten Instanz des <span class="caps">TSP</span> findet.</p>
<p><img alt="42 Hauptstädte in Amerika" class="invertable" height="560" src="/img/tsp.png" width="1000"/>
Das sind 42 Hauptstädte der Vereinigten Staaten von Amerika und Washington, <span class="caps">DC</span> (Hawaii und
Alaska, sowie einige Staaten an der Ostküste, die das Problem nicht schwieriger
machen, fehlen). Dieses Problem war das erste größere, das 1956 beweisbar
optimal gelöst wurde.</p>
<h3>Nearest Neighbor</h3>
<p><img alt="Nearest Neighbor" class="invertable" height="560" src="/img/tsp_nearestNeighbor.png" width="1000"/>
Die Nearest Neighbor Heuristik (<span class="math">\(\mathcal{O}(N^2)\)</span>) startet bei einer zufälligen Stadt und wählt
als nächste Stadt immer die Stadt, die am nächsten an der aktuellen Stadt ist und
noch nicht besucht wurde.</p>
<h3>Greedy</h3>
<p><img alt="Greedy" class="invertable" height="560" src="/img/tsp_greedy.png" width="1000"/>
Diese Heuristik (<span class="math">\(\mathcal{O}(N^2 \log N)\)</span>) ist ähnlich zu <a href="https://de.wikipedia.org/wiki/Algorithmus_von_Kruskal">Kruskals Algorithmus für minimal spannende Bäume</a>.
Sie nimmt die kürzeste Verbindung zwischen zwei Städten und fügt sie der Tour
hinzu, wenn sie in der Tour noch erlaubt ist.</p>
<h3>Farthest Insertion</h3>
<p><img alt="Farthest Insertion" class="invertable" height="560" src="/img/tsp_farIn.png" width="1000"/>
Farthest Insertion (<span class="math">\(\mathcal{O}(N^3)\)</span>) startet bei einer zufälligen Stadt und fügt dann die Stadt,
die am weitesten von der aktuellen Tour entfernt ist an der Stelle in die Tour,
die dafür sorgt, dass die Tour möglichst kurz bleibt.</p>
<h3>Two-Opt</h3>
<p><img alt="Two-Opt" class="invertable" height="560" src="/img/tsp_twoOpt.png" width="1000"/>
Two-Opt beginnt mit einer beliebigen Tour, die bspw. durch eine der obigen
Heuristken erstellt wurde und verbessert sie, indem sie zwei Verbindungen nimmt
und die Endpunkte über Kreuz austauscht, wenn die Tour dadurch verbunden bleibt
und kürzer wird.</p>
<h3>Lineare Programmierung mit „Subtour Elimination Cuts“</h3>
<p><img alt="Linear Programming" class="invertable" height="560" src="/img/tsp_LP.png" width="1000"/>
Lineare Programmierung (<span class="caps">LP</span>) zu erklären, würde diesen Artikel sprengen. Aber diese Methode liefert
untere Schranken für die Tourlänge und kann somit benutzt werden, um die
Qualität einer heuristischen Lösung abzuschätzen. Falls man die optimale
Lösung durch lineare Programmierung findet, erkennt man sie auch sofort als optimal.</p>
<p>Für weitere Details, kann ich auf einen <a href="http://arxiv.org/abs/1512.08554">arXiv Artikel</a>
von mir verweisen.</p>
<h3>Concorde</h3>
<p><img alt="Optimale Tour" class="invertable" height="560" src="/img/tsp_opt.png" width="1000"/>
<a href="http://www.math.uwaterloo.ca/tsp/concorde.html">Concorde</a>
ist der „State of the Art“ Solver für das Problem des Handlungsreisenden
und löst problemlos Instanzen mit mehr als 1000 Städten.
Intern benutzt es zwar eine Menge Heuristiken, allerdings auch lineare
Programmierung, um nachzuweisen, dass die gefundene Lösung optimal ist.</p>
<h2>Technische Details</h2>
<p>TSPview ist ein Python3 Programm, das zur Darstellung PyQt5 benutzt, das sich
per <code>pip3 install PyQt5</code> einfach installieren lässt.</p>
<p>Darüber hinaus enthält es eine optionale Abhängigkeit zu <span class="caps">CPLEX</span>, einem
kommerziellen <span class="caps">LP</span> solver.</p>
<h3>boost::python</h3>
<p>Da das Hauptprogramm in Python geschrieben ist, aber der <span class="caps">LP</span>-Teil in C++,
braucht man eine Möglichkeit der Kommunikation. Glücklicherweise gibt es
mit <a href="http://www.boost.org/doc/libs/1_61_0/libs/python/doc/html/index.html">boost::python</a>
eine Möglichkeit C++ Klassen in Python als Python-Klassen zu benutzen.</p>
<p>Um beispielsweise die C++ Klasse <code>MyClass</code>, deren Konstruktor einen Integer und
eine Python-Liste entgegen nehmen soll, in Python benutzen und <code>myMethod</code>
aufrufen zu können, reicht folgender Code:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;boost/python.hpp&gt;</span>
<span class="k">namespace</span><span class="w"> </span><span class="nn">py</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nn">boost</span><span class="o">::</span><span class="nn">python</span><span class="p">;</span>

<span class="c1">// implement MyClass</span>

<span class="n">BOOST_PYTHON_MODULE</span><span class="p">(</span><span class="n">MyClass</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">py</span><span class="o">::</span><span class="n">class_</span><span class="o">&lt;</span><span class="n">MyClass</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"MyClass"</span><span class="p">,</span><span class="w"> </span><span class="n">py</span><span class="o">::</span><span class="n">init</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="w"> </span><span class="n">py</span><span class="o">::</span><span class="n">list</span><span class="o">&gt;</span><span class="p">())</span>
<span class="w">        </span><span class="p">.</span><span class="n">def</span><span class="p">(</span><span class="s">"myMethod"</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">MyClass</span><span class="o">::</span><span class="n">myMethod</span><span class="p">)</span>
<span class="w">    </span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</article>
<article class="post">
<header>
<h2 class="post-title">
<a href="https://blog.schawe.me/simulatedsort.html"> SimulatedSort  </a>
</h2>
<div class="post-meta">
<time class="post-time" datetime="2014-06-14T15:20:00+02:00">14.06.2014</time>
<span class="category category-code">
<a href="https://blog.schawe.me/categories.html#code-ref">Code</a>
</span>
<span class="tags-in-article">
<span class="tag">
<a href="https://blog.schawe.me/tags.html#github-ref">GitHub</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#physik-ref">Physik</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/tags.html#python-ref">Python</a>
</span>
</span>
</div>
</header>
<div class="post-content">
<p><a href="http://de.wikipedia.org/wiki/Simulated_annealing">Simulated Annealing</a>
ist eine Optimierungsmethode, die von natürlichen
Kristallisationsprozessen inspiriert ist. Man startet in der Schmelze
bei hohen Temperaturen und lässt es dann abkühlen, sodass die Atome sich
in einem Zustand minimaler Energie anordnen, dem Kristallgitter. Wenn
man also für ein Optimierungsproblem die zu optimierende Größe als
Energie ansieht, und man eine Lösung durch eine kleine Änderung in eine
andere Lösung verwandeln kann, kann man mit dieser Methode eine Näherung
für das Optimum finden.</p>
<p>Wenn wir also eine Sequenz <span class="math">\(S\)</span> von <span class="math">\(N\)</span> Zahlen sortieren wollen, können wir die
Summe der Differenzen zwischen benachbarten Zahlen als Energie
betrachten, denn die ist minimal in einer sortierten Liste.
</p>
<div class="math">\begin{equation}
    \mathcal{H} = \sum_{i=1}^{N-1} \left| S_i - S_{i+1} \right|
\end{equation}</div>
<p>
Um eine Lösung in eine andere zu verwandeln, reicht es zwei Elemente der Sequenz
zu tauschen.</p>
<p>Der Kern von Simulated Annealing ist der Metropolis Algorithmus.</p>
<ol>
<li>Starte bei einer hohen Temperatur <span class="math">\(T\)</span>.</li>
<li>Berechne die Energie <span class="math">\(\mathcal{H}(S)\)</span> der aktuellen Konfiguration <span class="math">\(S\)</span>.</li>
<li>Erzeuge eine neue Konfiguration <span class="math">\(R\)</span> durch eine kleine Änderunge von <span class="math">\(S\)</span>.</li>
<li>Akzeptiere <span class="math">\(R\)</span> mit der Wahscheinlichkeit
   <div class="math">$$p_\mathrm{acc} = \min\left[1 ,\exp(-(\mathcal{H}(R) - \mathcal{H}(S))/T) \right],$$</div>
   sodass eine „sortiertere“ Sequenz immer akzeptiert wird und eine „unsortiertere“
   vor allem bei hohen Temperaturen. Wenn <span class="math">\(R\)</span> akzeptiert wird, gilt <span class="math">\(S:=R\)</span>,
   ansonsten wir die alte Konfiguration <span class="math">\(S\)</span> weiter benutzt.</li>
<li>Reduziere die Temperatur (beispielsweise durch Multiplikation mit einer Zahl
   etwas kleiner als 1) und breche ab, wenn die Zieltemperatur erreicht ist.
   Ansonsten beginne wieder bei Punkt 2.</li>
</ol>
<p>Genug der Theorie: In einem <a href="https://gist.github.com/surt91/e399500e780e184d9ac7">Gist auf GitHub</a>
präsentiere ich ein schnell terminierendes
Sortierprogramm, das zwar nicht immer eine sortierte Liste findet, aber
zumindest eine Näherung! Es ist also
<a href="http://de.wikipedia.org/wiki/Bogosort">Bogosort</a> in mehr als nur einer
Hinsicht überlegen!</p>
<p>Wer braucht da noch <span class="math">\(\mathcal{O}(N \log(N))\)</span> Sortier-Algorithmen?!</p>
</div>
</article>
</div>
<div class="post-navigation">
<nav class="pagination">
<a href="https://blog.schawe.me/category/code6.html">← Neuer</a>
<span class="separatordot">·</span>
<a href="https://blog.schawe.me/category/code8.html">Älter →</a>
<br/>
            7 / 13
        </nav>
</div>
</div>
<div id="last-update">
<time datetime="2024-12-27 10:29:03">10:29:03 27.12.2024</time>
</div>
</div>
<script async="" src="/theme/webassets-external/0cf7968c252ead5c096e55c1f7673096_rythm.js"></script>
<script async="" src="/theme/webassets-external/a8b690a4c23c0610ea6538a9352534be_totally_serious_script.js"></script>
<script async="" src="/theme/js/unregister_service_worker.js"></script>
</body>
</html>