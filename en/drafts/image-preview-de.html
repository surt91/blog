<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Platzhalterbilder  · möchte­gern­geek</title>
<meta content="Große Bilder können die Ladezeit von Webseiten dramatisch verschlechtern. Schlimmer als weiße Flächen ist das sprungartige Verschieben des Textes, wenn weiter oben gerade ein Bild fertig geladen wurde. Allerdings müssen Bilder bei immer weiter steigenden Pixeldichten der Anzeigegeräte auch immer hochaufgelöster werden und gleichzeitig über langsame 3G-Verbindungen geladen werden. Da …" name="description"/>
<meta content="Hendrik Schawe" name="author"/>
<meta content="Hendrik Schawe" name="copyright"/>
<meta content="#3d4f5d" name="theme-color"/>
<link href="/manifest.json" rel="manifest"/>
<link href="/favicon.ico" rel="icon" type="image/x-icon"/>
<!-- Add to home screen for Safari on iOS-->
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="default" name="apple-mobile-web-app-status-bar-style"/>
<meta content="möchtegerngeek" name="apple-mobile-web-app-title"/>
<link href="/extra/icons/icon-152x152.png" rel="apple-touch-icon"/>
<!-- Add to home screen for Windows-->
<meta content="/extra/icons/icon-152x152.png" name="msapplication-TileImage"/>
<meta content="#b0cadb" name="msapplication-TileColor"/>
<meta content="möchte­gern­geek" property="og:site_name"/>
<meta content="Hendrik Schawe" property="og:article:author"/>
<meta content="article" property="og:type"/>
<meta content="summary" name="twitter:card"/>
<meta content="Bild, JavaScript, Python, Meta, " name="keywords"/>
<meta content="Platzhalterbilder " name="twitter:title">
<meta content="Große Bilder können die Ladezeit von Webseiten dramatisch verschlechtern. Schlimmer als weiße Flächen ist das sprungartige Verschieben des Textes, wenn weiter oben gerade ein Bild fertig geladen wurde. Allerdings müssen Bilder bei immer weiter steigenden Pixeldichten der Anzeigegeräte auch immer hochaufgelöster werden und gleichzeitig über langsame 3G-Verbindungen geladen werden. Da …" name="twitter:description">
<meta content="Platzhalterbilder " name="og:title">
<meta content="Große Bilder können die Ladezeit von Webseiten dramatisch verschlechtern. Schlimmer als weiße Flächen ist das sprungartige Verschieben des Textes, wenn weiter oben gerade ein Bild fertig geladen wurde. Allerdings müssen Bilder bei immer weiter steigenden Pixeldichten der Anzeigegeräte auch immer hochaufgelöster werden und gleichzeitig über langsame 3G-Verbindungen geladen werden. Da …" name="og:description">
<meta content="drafts/image-preview-de.html" property="og:url">
<meta content="2017-11-29T10:21:00+01:00" property="og:article:published_time">
<meta content="https://blog.schawe.me/img/logo.png" property="og:image"/>
<meta content="https://blog.schawe.me/img/logo.png" name="twitter:image"/>
<link href="https://blog.schawe.me/drafts/image-preview-de.html" hreflang="de" rel="alternate">
<link href="https://blog.schawe.me/drafts/image-preview-de.html" hreflang="de" rel="alternate">
<link href="https://blog.schawe.me/drafts/image-preview-de.html" hreflang="x-default" rel="alternate">
<link href="/theme/css/pure-min.css" rel="stylesheet" type="text/css"/>
<link href="/theme/css/grids-responsive-min.css" rel="stylesheet" type="text/css"/>
<link href="/theme/css/blog.css" rel="stylesheet" type="text/css"/>
<script async="" src="/theme/js/mathjax-config.js"></script>
<script async="" crossorigin="anonymous" data-search-pseudo-elements="" integrity="sha512-RXf+QSDCUQs5uwRKaDoXt55jygZZm2V++WUZduaU/Ui/9EGp3f/2KZVahFZBKGH0s774sd3HmrhUy+SgOFQLVQ==" referrerpolicy="no-referrer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js"></script>
<!-- Preload the other fonts early -->
<link as="font" crossorigin="anonymous" href="/theme/woff2/Merriweather-12ptRegular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/FiraSans-Regular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/FiraSans-Bold.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/Merriweather-12ptItalic.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/firacode-regular.woff2" rel="prefetch" type="font/woff2"/>
<link as="font" crossorigin="anonymous" href="/theme/woff2/firacode-bold.woff2" rel="prefetch" type="font/woff2"/>
<link href="https://blog.schawe.me/feeds/all.atom.xml" rel="alternate" title="möchte­gern­geek - Full Atom Feed" type="application/atom+xml">
</link></link></link></link></meta></meta></meta></meta></meta></meta></head>
<body>
<div class="pure-g" id="layout">
<div class="sidebar pure-u-1 pure-u-lg-1-4">
<div class="header">
<h1 class="brand-title"><a href="https://blog.schawe.me/en">möchte­gern­geek</a></h1>
<nav class="nav">
<ul class="nav-list container">
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/"><i class="fa fa-globe"></i> de</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/en/categories.html">Categories</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/en/tags.html">Tags</a>
</li>
<li class="nav-item">
<a class="pure-button" href="https://blog.schawe.me/en/archives.html">Archive</a>
</li>
</ul>
</nav>
<div class="container">
<a class="sidebar-social-links" href="https://hendrik.schawe.me" rel="noopener" target="_blank" title="Ich">
<i class="fas fa-user sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="https://github.com/surt91" rel="noopener" target="_blank" title="GitHub">
<i class="fab fa-github sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="mailto:hendrik.schawe+blog@gmail.com" rel="noopener" target="_blank" title="Email">
<i class="fas fa-envelope sidebar-social-links"></i>
</a>
<a class="sidebar-social-links" href="https://twitter.com/surt91" rel="noopener" target="_blank" title="Twitter">
<i class="fab fa-twitter sidebar-social-links"></i>
</a>
</div>
<div class="container">
<form action="https://blog.schawe.me/en/search.html" class="pure-form">
<fieldset>
<input aria-label="Search" class="search-query" id="tipue_search_input" name="q" placeholder="Search" type="text"/>
</fieldset>
</form>
</div>
</div>
</div>
<div class="content pure-u-1 pure-u-lg-3-4">
<article class="post">
<header>
<h2 class="post-title">
<a href="https://blog.schawe.me/en/drafts/image-preview-de.html"> Platzhalterbilder  </a>
</h2>
<div class="post-meta">
<time class="post-time" datetime="2017-11-29T10:21:00+01:00">29.11.2017</time>
<span class="category category-meta">
<a href="https://blog.schawe.me/en/categories.html#meta-ref">Meta</a>
</span>
<span class="tags-in-article">
<span class="tag">
<a href="https://blog.schawe.me/en/tags.html#bild-ref">Bild</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/en/tags.html#javascript-ref">JavaScript</a>
</span>
<span class="tag">
<a href="https://blog.schawe.me/en/tags.html#python-ref">Python</a>
</span>
</span>
</div>
</header>
<div class="post-content">
<p>Große Bilder können die Ladezeit von Webseiten dramatisch verschlechtern.
Schlimmer als weiße Flächen ist das sprungartige Verschieben des Textes, wenn
weiter oben gerade ein Bild fertig geladen wurde. Allerdings müssen Bilder bei
immer weiter steigenden Pixeldichten der Anzeigegeräte auch immer
hochaufgelöster werden und gleichzeitig über langsame 3G-Verbindungen
geladen werden.</p>
<p>Da der <a href="https://blog.schawe.me/en/randomFractals-de.html">Eintrag über Fraktale</a> einige recht große
Bilder enthält, habe ich ein Pelican-Plugin geschrieben, das</p>
<ol>
<li>Vorschau-.jpg erzeugt, die in der Regel kleiner als 1 kB sind,</li>
<li>jedes Bild durch die data-uri des Previews ersetzt und dies verschwommen anzeigt, bis das Originalbild per JavaScript nachgeladen ist.</li>
</ol>
<p>Das sieht dann etwa so aus:</p>
<video controls="" height="460" width="800">
<source src="/vid/image_preview.mp4" type="video/mp4"/>
Your browser does not support the video tag.
</video>
<p>Glücklicherweise ist es recht einfach mit Python html zu parsen und data-uri
zu erzeugen, sodass mein Plugin im Wesentlichen fertig generiertes html nimmt
und folgendes tut:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"file.html"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">"html.parser"</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">"img"</span><span class="p">):</span>
        <span class="n">thumbnail</span> <span class="o">=</span> <span class="n">create_thumbnail</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">b64</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">thumbnail</span><span class="p">,</span> <span class="s2">"rb"</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)</span>
        <span class="n">data_uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"data:image/jpeg;base64,</span><span class="si">{</span><span class="n">b64</span><span class="si">}</span><span class="s2">"</span>
        <span class="c1"># TODO: replace img source by the data-uri</span>
</code></pre></div>
<p>Nachdem alles vorbereitet ist, ist die clientseitige Logik mit ein paar Zeilen
<a href="https://github.com/surt91/purepelican/blob/1e1371d644de4b3af733e78bebe4869bc9121681/static/js/img.js">JavaScript</a>
und <a href="https://github.com/surt91/purepelican/blob/1e1371d644de4b3af733e78bebe4869bc9121681/static/sass/_images.scss"><span class="caps">CSS</span></a>
recht simpel.</p>
<p>Die Idee ist, dynamisch die voll aufgelösten Bilder per JavaScript zu laden und
mit dem <code>onLoad</code> Event sichtbar zu machen.</p>
</div>
</article>
<div class="post-navigation">
<nav class="pagination">
<br/>
</nav>
</div>
</div>
<div id="last-update">
<time datetime="2024-12-27 10:29:03">10:29:03 27.12.2024</time>
</div>
</div>
<script async="" src="/theme/fx/rythm.js"></script>
<script async="" src="/theme/fx/totally_serious_script.js"></script>
<script async="" src="/theme/js/unregister_service_worker.js"></script>
</body>
</html>